<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹ä¹ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, getDocs, collection, query, where, writeBatch, runTransaction } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Firestoreã®ãƒ‡ãƒãƒƒã‚°ãƒ¬ãƒ™ãƒ«ã‚’è¨­å®š
        setLogLevel('Debug');

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ï¼ˆCanvasç’°å¢ƒã‹ã‚‰æä¾›ã•ã‚Œã‚‹ã‚‚ã®ã‚’å–å¾—ï¼‰
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        let firebaseConfig = {};
        try {
            firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        } catch (e) {
            console.error("Firebase config is invalid:", e);
        }
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db = null;
        let auth = null;
        let userId = null;
        let unsubscribePersonalBest = null;
        let unsubscribeDailyBest = null;

        // UIè¦ç´ 
        const startButton = document.getElementById('startButton');
        const quizArea = document.getElementById('quizArea');
        const recordsArea = document.getElementById('recordsArea');
        const currentScore = document.getElementById('currentScore');
        const personalBestDisplay = document.getElementById('personalBestDisplay');
        const dailyBestDisplay = document.getElementById('dailyBestDisplay');
        const congratsModal = document.getElementById('congratsModal');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseButton = document.getElementById('modalCloseButton');
        const loadingIndicator = document.getElementById('loadingIndicator');

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let problems = [];
        let currentProblemIndex = 0;
        let startTime = 0;
        let personalBestTimeMs = Infinity; // å€‹äººã®æœ€é«˜è¨˜éŒ²ï¼ˆãƒŸãƒªç§’ã€å°ã•ã„ã»ã©è‰¯ã„ï¼‰
        let dailyBestTimeMs = Infinity; // ä¸€æ—¥ã®æœ€é«˜è¨˜éŒ²ï¼ˆãƒŸãƒªç§’ã€å°ã•ã„ã»ã©è‰¯ã„ï¼‰
        
        // Firestoreãƒ‘ã‚¹ç”Ÿæˆé–¢æ•°
        const getPersonalBestDocRef = () => doc(db, `artifacts/${appId}/users/${userId}/kuku_practice_data`, 'personal_best');
        const getDailyBestDocRef = () => doc(db, `artifacts/${appId}/public/data/kuku_practice_daily_best`, 'daily_best_record');
        
        // æ—¥ä»˜ã‚’YYYY-MM-DDå½¢å¼ã§å–å¾—
        const getTodayDateString = () => {
            return new Intl.DateTimeFormat('fr-CA', { year: 'numeric', month: '2-digit', day: '2-digit' }).format(new Date());
        };

        // FirebaseåˆæœŸåŒ–ã¨èªè¨¼
        const initializeFirebase = async () => {
            try {
                if (Object.keys(firebaseConfig).length === 0) {
                    console.error("Firebase config is missing.");
                    return;
                }
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        document.getElementById('userIdDisplay').textContent = `ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: ${userId}`;
                        setupRealtimeListeners();
                        loadingIndicator.classList.add('hidden');
                        startButton.disabled = false;
                    } else {
                        userId = null;
                        document.getElementById('userIdDisplay').textContent = 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: æœªèªè¨¼';
                        loadingIndicator.classList.remove('hidden');
                        startButton.disabled = true;
                    }
                });

            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
                loadingIndicator.textContent = 'åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
            }
        };

        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        const setupRealtimeListeners = () => {
            if (!db || !userId) return;

            // 1. å€‹äººã®æœ€é«˜è¨˜éŒ²ãƒªã‚¹ãƒŠãƒ¼
            if (unsubscribePersonalBest) unsubscribePersonalBest();
            unsubscribePersonalBest = onSnapshot(getPersonalBestDocRef(), (docSnapshot) => {
                if (docSnapshot.exists()) {
                    const data = docSnapshot.data();
                    personalBestTimeMs = data.bestTimeMs || Infinity;
                    personalBestDisplay.textContent = formatTime(personalBestTimeMs);
                } else {
                    personalBestTimeMs = Infinity;
                    personalBestDisplay.textContent = 'ãªã—';
                }
            }, (error) => console.error("Error reading personal best:", error));

            // 2. ä¸€æ—¥ã®æœ€é«˜è¨˜éŒ²ãƒªã‚¹ãƒŠãƒ¼
            if (unsubscribeDailyBest) unsubscribeDailyBest();
            unsubscribeDailyBest = onSnapshot(getDailyBestDocRef(), (docSnapshot) => {
                const today = getTodayDateString();
                if (docSnapshot.exists()) {
                    const data = docSnapshot.data();
                    if (data.date === today) {
                        dailyBestTimeMs = data.bestTimeMs || Infinity;
                        dailyBestDisplay.textContent = `${formatTime(dailyBestTimeMs)} (ID: ${data.bestUserId.substring(0, 4)}...)`;
                    } else {
                        // æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸã‚‰ãƒªã‚»ãƒƒãƒˆ
                        dailyBestTimeMs = Infinity;
                        dailyBestDisplay.textContent = 'ä»Šæ—¥ã®è¨˜éŒ²ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“';
                        // DBä¸Šã®æ—¥ä»˜ã‚‚æ›´æ–°
                        resetDailyBest(today); 
                    }
                } else {
                    dailyBestTimeMs = Infinity;
                    dailyBestDisplay.textContent = 'ä»Šæ—¥ã®è¨˜éŒ²ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“';
                }
            }, (error) => console.error("Error reading daily best:", error));
        };

        // æ—¥ä»˜ãŒå¤‰ã‚ã£ãŸéš›ã«ãƒ‡ã‚¤ãƒªãƒ¼ãƒ™ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ/åˆæœŸåŒ–
        const resetDailyBest = async (today) => {
             try {
                await setDoc(getDailyBestDocRef(), {
                    date: today,
                    bestTimeMs: Infinity,
                    bestUserId: ''
                }, { merge: true });
                console.log("Daily best record initialized for new day:", today);
            } catch (e) {
                console.error("Error resetting daily best:", e);
            }
        }
        
        // æ™‚é–“ã‚’æ•´å½¢ (ãƒŸãƒªç§’ -> ç§’.ãƒŸãƒªç§’)
        const formatTime = (ms) => {
            if (ms === Infinity) return 'ãªã—';
            return (ms / 1000).toFixed(2) + 'ç§’';
        };

        // 6, 7, 8, 9ã®æ®µã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ãªä¹ä¹ã®å•é¡Œã‚’5å•ç”Ÿæˆ
        const generateProblems = () => {
            problems = [];
            const tables = [6, 7, 8, 9];
            for (let i = 0; i < 5; i++) {
                // æ›ã‘ã‚‰ã‚Œã‚‹æ•° (6, 7, 8, 9)
                const factor1 = tables[Math.floor(Math.random() * tables.length)];
                // æ›ã‘ã‚‹æ•° (1ã‹ã‚‰9)
                const factor2 = Math.floor(Math.random() * 9) + 1;
                problems.push({
                    q: `${factor1} Ã— ${factor2}`,
                    answer: factor1 * factor2,
                    inputRef: null // å¾Œã§DOMè¦ç´ ã‚’ä¿æŒ
                });
            }
            return problems;
        };

        // ã‚¯ã‚¤ã‚ºé–‹å§‹
        const startQuiz = () => {
            if (!userId) {
                // UIã§ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºãŒæœ›ã¾ã—ã„ãŒã€ä»Šå›ã¯console.error
                console.error("ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãŒå®Œäº†ã—ã¦ã„ã¾ã›ã‚“ã€‚");
                return;
            }
            
            // å•é¡Œã‚’ç”Ÿæˆ
            generateProblems();
            currentProblemIndex = 0;
            startTime = Date.now();
            currentScore.textContent = 'è¨ˆæ¸¬ä¸­...';
            quizArea.innerHTML = ''; // å•é¡Œã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªã‚¢
            
            // å•é¡Œã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            problems.forEach((p, index) => {
                const problemDiv = document.createElement('div');
                problemDiv.className = 'flex items-center space-x-4 mb-4 p-3 bg-white rounded-lg shadow-md';
                
                const questionP = document.createElement('p');
                questionP.className = 'text-2xl font-bold text-gray-700 w-1/3';
                questionP.textContent = `ç¬¬${index + 1}å•: ${p.q} =`;

                const input = document.createElement('input');
                input.type = 'number';
                input.min = '1';
                input.className = 'w-2/3 p-3 border-2 border-indigo-300 rounded-md text-xl focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 ease-in-out';
                input.placeholder = 'ç­”ãˆã‚’å…¥åŠ›';
                input.id = `input-${index}`;
                
                // Enterã‚­ãƒ¼ã§æ¬¡ã®å•é¡Œã¸
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        // ç¾åœ¨ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¦‹ã¤ã‘ã€æ¬¡ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’ç§»ã™
                        const nextIndex = index + 1;
                        if (nextIndex < problems.length) {
                            document.getElementById(`input-${nextIndex}`).focus();
                        } else {
                            // æœ€å¾Œã®å•é¡Œã§EnterãŒæŠ¼ã•ã‚ŒãŸã‚‰æ¡ç‚¹
                            submitQuiz();
                        }
                    }
                });
                
                problemDiv.appendChild(questionP);
                problemDiv.appendChild(input);
                quizArea.appendChild(problemDiv);
                
                // inputè¦ç´ ã¸ã®å‚ç…§ã‚’ä¿å­˜
                p.inputRef = input;
            });
            
            // æ¡ç‚¹ãƒœã‚¿ãƒ³
            const submitButton = document.createElement('button');
            submitButton.id = 'submitButton';
            submitButton.className = 'w-full py-3 mt-4 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition duration-150 ease-in-out shadow-lg';
            submitButton.textContent = 'æ¡ç‚¹ã™ã‚‹ï¼';
            submitButton.onclick = submitQuiz;
            quizArea.appendChild(submitButton);

            startButton.textContent = 'ã‚‚ã†ä¸€åº¦ãƒãƒ£ãƒ¬ãƒ³ã‚¸';
            // æœ€åˆã®å•é¡Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            document.getElementById('input-0').focus();
        };

        // ã‚¯ã‚¤ã‚ºæå‡ºã¨æ¡ç‚¹
        const submitQuiz = () => {
            const endTime = Date.now();
            let correctCount = 0;
            let totalTimeMs = endTime - startTime;
            
            problems.forEach((p, index) => {
                const inputElement = document.getElementById(`input-${index}`);
                const userAnswer = parseInt(inputElement.value, 10);
                
                // æ¡ç‚¹ã¨UIãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
                if (userAnswer === p.answer) {
                    correctCount++;
                    inputElement.parentElement.classList.remove('bg-white');
                    inputElement.parentElement.classList.add('bg-green-100', 'border-l-4', 'border-green-500');
                    inputElement.disabled = true;
                } else {
                    inputElement.parentElement.classList.remove('bg-white');
                    inputElement.parentElement.classList.add('bg-red-100', 'border-l-4', 'border-red-500');
                    inputElement.disabled = true;
                    // æ­£ã—ã„ç­”ãˆã‚’è¡¨ç¤ºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
                    const answerSpan = document.createElement('span');
                    answerSpan.className = 'text-sm text-red-600 font-semibold ml-2';
                    answerSpan.textContent = `æ­£è§£: ${p.answer}`;
                    inputElement.parentElement.appendChild(answerSpan);
                }
            });

            const submitButton = document.getElementById('submitButton');
            if (submitButton) {
                submitButton.disabled = true;
                submitButton.textContent = 'æ¡ç‚¹å®Œäº†';
            }

            // å…¨å•æ­£è§£ã‹ã¤æ™‚é–“è¨ˆæ¸¬ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿è¨˜éŒ²ã‚’æ›´æ–°
            if (correctCount === problems.length && totalTimeMs > 0) {
                currentScore.textContent = `ã‚¹ã‚³ã‚¢: ${formatTime(totalTimeMs)} (å…¨å•æ­£è§£!)`;
                checkAndUpdateRecords(totalTimeMs);
            } else {
                currentScore.textContent = `ã‚¹ã‚³ã‚¢: å¤±æ•— (${correctCount}/${problems.length}å•æ­£è§£)`;
            }
        };

        // è¨˜éŒ²ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å¿…è¦ã«å¿œã˜ã¦æ›´æ–°
        const checkAndUpdateRecords = async (newTimeMs) => {
            let isPersonalBest = false;
            let isDailyBest = false;
            
            // 1. å€‹äººã®æœ€é«˜è¨˜éŒ²ã‚’ãƒã‚§ãƒƒã‚¯ãƒ»æ›´æ–°
            if (newTimeMs < personalBestTimeMs) {
                isPersonalBest = true;
                await setDoc(getPersonalBestDocRef(), { bestTimeMs: newTimeMs });
                console.log("Personal best updated:", newTimeMs);
            }

            // 2. ä¸€æ—¥ã®æœ€é«˜è¨˜éŒ²ã‚’ãƒã‚§ãƒƒã‚¯ãƒ»æ›´æ–° (ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨)
            const dailyRef = getDailyBestDocRef();
            const today = getTodayDateString();

            try {
                await runTransaction(db, async (transaction) => {
                    const dailyDoc = await transaction.get(dailyRef);
                    let currentDailyBest = Infinity;
                    let dailyData = { date: today, bestTimeMs: Infinity, bestUserId: userId };

                    if (dailyDoc.exists()) {
                        dailyData = dailyDoc.data();
                        currentDailyBest = dailyData.bestTimeMs || Infinity;
                    }

                    // æ—¥ä»˜ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                    if (dailyData.date !== today || currentDailyBest === Infinity) {
                        // æ–°ã—ã„æ—¥ã€ã¾ãŸã¯ã¾ã è¨˜éŒ²ãŒãªã„å ´åˆ
                        dailyData = { date: today, bestTimeMs: newTimeMs, bestUserId: userId };
                        isDailyBest = true;
                    } else if (newTimeMs < currentDailyBest) {
                        // æ—¢å­˜ã®è¨˜éŒ²ã‚ˆã‚Šé€Ÿã„å ´åˆ
                        dailyData.bestTimeMs = newTimeMs;
                        dailyData.bestUserId = userId;
                        isDailyBest = true;
                    } else {
                        isDailyBest = false;
                    }

                    if (isDailyBest) {
                        transaction.set(dailyRef, dailyData);
                        console.log("Daily best updated:", newTimeMs);
                    }
                });
            } catch (e) {
                console.error("Daily best transaction failed:", e);
            }

            // 3. ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            if (isPersonalBest || isDailyBest) {
                showCongrats(isPersonalBest, isDailyBest, newTimeMs);
            }
        };
        
        // ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
        const showCongrats = (isPersonal, isDaily, timeMs) => {
            let message = `ã‚¿ã‚¤ãƒ : ${formatTime(timeMs)}ã§ã€è¦‹äº‹ãªè¨˜éŒ²ã§ã™ï¼\n\n`;
            if (isPersonal) {
                message += 'ğŸ† å€‹äººã®æœ€é«˜è¨˜éŒ²ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\n';
            }
            if (isDaily) {
                message += 'ğŸ¥‡ ä»Šæ—¥ã®ä¸€æ—¥ã®æœ€é«˜è¨˜éŒ²ã‚’é”æˆã—ã¾ã—ãŸï¼ç´ æ™´ã‚‰ã—ã„ï¼\n';
            }
            
            modalMessage.textContent = message;
            congratsModal.classList.remove('hidden');
        }

        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        modalCloseButton.onclick = () => {
            congratsModal.classList.add('hidden');
        };

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        window.onload = () => {
            initializeFirebase();
            startButton.onclick = startQuiz;
        };

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦HTMLã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ã™ã‚‹ (Type="module"ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã“ã‚Œã¯å¿…è¦ãªã„ãŒå¿µã®ãŸã‚)
        window.startQuiz = startQuiz;
        window.submitQuiz = submitQuiz;

    </script>
    <style>
        /* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ« */
        @keyframes pulse-success {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .congrats-card {
            animation: pulse-success 0.5s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-8 font-sans">

    <div class="max-w-4xl mx-auto bg-white p-6 sm:p-10 rounded-xl shadow-2xl">
        <h1 class="text-4xl font-extrabold text-indigo-700 mb-6 text-center">ä¹ä¹ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h1>
        <p id="userIdDisplay" class="text-sm text-gray-500 text-center mb-4">ãƒ¦ãƒ¼ã‚¶ãƒ¼ID: ãƒ­ãƒ¼ãƒ‰ä¸­...</p>

        <!-- ãƒ­ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ -->
        <div id="loadingIndicator" class="text-center p-4">
            <div class="animate-spin inline-block w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full" role="status"></div>
            <p class="text-indigo-600 mt-2">ãƒ‡ãƒ¼ã‚¿ã¨èªè¨¼ã‚’ãƒ­ãƒ¼ãƒ‰ä¸­...</p>
        </div>

        <!-- è¨˜éŒ²ã‚¨ãƒªã‚¢ -->
        <div id="recordsArea" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
            <div class="bg-blue-100 p-4 rounded-lg shadow-inner text-center">
                <p class="text-sm font-semibold text-blue-700">ç¾åœ¨ã®ã‚¹ã‚³ã‚¢</p>
                <p id="currentScore" class="text-3xl font-extrabold text-blue-900 mt-1">æœªæŒ‘æˆ¦</p>
            </div>
            <div class="bg-purple-100 p-4 rounded-lg shadow-inner text-center">
                <p class="text-sm font-semibold text-purple-700">å€‹äººã®æœ€é«˜è¨˜éŒ²</p>
                <p id="personalBestDisplay" class="text-3xl font-extrabold text-purple-900 mt-1">ãƒ­ãƒ¼ãƒ‰ä¸­</p>
            </div>
            <div class="bg-yellow-100 p-4 rounded-lg shadow-inner text-center">
                <p class="text-sm font-semibold text-yellow-700">ä»Šæ—¥ã®ä¸€æ—¥ã®æœ€é«˜è¨˜éŒ²</p>
                <p id="dailyBestDisplay" class="text-3xl font-extrabold text-yellow-900 mt-1">ãƒ­ãƒ¼ãƒ‰ä¸­</p>
            </div>
        </div>

        <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨èª¬æ˜ -->
        <div class="text-center mb-8 p-6 bg-indigo-50 rounded-lg border-l-4 border-indigo-400">
            <p class="text-gray-700 mb-4">
                <span class="font-bold">ãƒ«ãƒ¼ãƒ«:</span> 6, 7, 8, 9ã®æ®µã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«5å•å‡ºé¡Œã•ã‚Œã¾ã™ã€‚å…¨å•æ­£è§£ã™ã‚‹ã¾ã§ã®ã‚¿ã‚¤ãƒ ã‚’ç«¶ã„ã¾ã™ã€‚
            </p>
            <button id="startButton" disabled class="w-full sm:w-1/2 py-4 bg-indigo-600 hover:bg-indigo-700 text-white font-bold text-xl rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105 disabled:bg-indigo-300">
                ãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ (5å•)
            </button>
        </div>

        <!-- ã‚¯ã‚¤ã‚ºã‚¨ãƒªã‚¢ -->
        <div id="quizArea" class="mt-8">
            <!-- å•é¡ŒãŒã“ã“ã«å‹•çš„ã«æŒ¿å…¥ã•ã‚Œã¾ã™ -->
        </div>
    </div>
    
    <!-- ãŠç¥ã„ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="congratsModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-xl shadow-2xl max-w-sm w-full text-center congrats-card border-4 border-yellow-500">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h3 class="text-3xl font-bold text-green-600 mb-4">è¨˜éŒ²é”æˆï¼</h3>
            <p id="modalMessage" class="text-lg text-gray-700 whitespace-pre-line"></p>
            <button id="modalCloseButton" class="mt-6 py-2 px-6 bg-indigo-500 hover:bg-indigo-600 text-white font-semibold rounded-lg transition duration-150">
                é–‰ã˜ã‚‹
            </button>
        </div>
    </div>

</body>
</html>